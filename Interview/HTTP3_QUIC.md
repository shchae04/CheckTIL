# HTTP/3 및 QUIC (Quick UDP Internet Connections)

HTTP/3는 웹 통신을 위한 최신 프로토콜로, QUIC이라는 새로운 전송 프로토콜을 기반으로 합니다. 이는 기존 HTTP/1.1 및 HTTP/2의 한계를 극복하기 위해 설계되었습니다.

## 1. HTTP/3 및 QUIC 개요

### HTTP/3 정의
- HTTP/3는 HTTP 프로토콜의 세 번째 주요 버전입니다.
- TCP 대신 QUIC(UDP 기반)을 전송 계층으로 사용합니다.
- 2022년에 IETF에 의해 표준화되었습니다(RFC 9114).

### QUIC 정의
- QUIC은 "Quick UDP Internet Connections"의 약자입니다.
- Google에서 처음 개발하고 2012년에 실험적으로 도입했습니다.
- UDP를 기반으로 하지만 TCP와 유사한 신뢰성을 제공합니다.
- TLS 1.3이 기본적으로 내장되어 있습니다.

## 2. HTTP/3 및 QUIC의 역사

### 개발 배경
- Google은 2012년에 SPDY 프로토콜의 한계를 극복하기 위해 QUIC 개발을 시작했습니다.
- 초기에는 "Google QUIC" 또는 "gQUIC"로 알려졌습니다.
- 2015년에 IETF에 표준화를 위해 제출되었습니다.
- IETF는 gQUIC를 기반으로 "IETF QUIC"을 개발했습니다.
- 2022년 6월, HTTP/3가 RFC 9114로 공식 표준화되었습니다.

### 표준화 과정
- QUIC: RFC 9000 (2021년 5월)
- HTTP/3: RFC 9114 (2022년 6월)
- QPACK(HTTP/3의 헤더 압축): RFC 9204 (2022년 6월)

## 3. QUIC의 주요 특징

### 1. UDP 기반 프로토콜
- TCP 대신 UDP를 사용하여 더 빠른 연결 설정이 가능합니다.
- 애플리케이션 레벨에서 신뢰성, 혼잡 제어, 흐름 제어를 구현합니다.

### 2. 연결 설정 시간 단축
- 0-RTT(Round Trip Time) 또는 1-RTT 연결 설정을 지원합니다.
- 재연결 시 이전 연결 정보를 사용하여 즉시 데이터 전송이 가능합니다.

```
TCP + TLS 1.3 연결 설정: 최소 2-RTT
QUIC 연결 설정: 최소 0-RTT (재연결 시) 또는 1-RTT (첫 연결)
```

### 3. 향상된 멀티플렉싱
- 독립적인 스트림을 통해 진정한 멀티플렉싱을 제공합니다.
- TCP의 Head-of-Line(HOL) 블로킹 문제를 완전히 해결합니다.

### 4. 연결 마이그레이션
- 클라이언트의 IP 주소가 변경되어도 연결을 유지할 수 있습니다.
- 모바일 기기가 Wi-Fi에서 셀룰러 네트워크로 전환할 때 유용합니다.

### 5. 내장된 암호화
- TLS 1.3이 기본적으로 내장되어 있습니다.
- 헤더를 포함한 거의 모든 연결 정보가 암호화됩니다.
- 중간자 공격에 대한 보안이 강화되었습니다.

### 6. 개선된 오류 처리
- 패킷 손실이 발생해도 해당 스트림만 영향을 받습니다.
- 다른 스트림은 계속해서 데이터를 주고받을 수 있습니다.

## 4. HTTP/3의 주요 특징

### 1. QUIC 기반 프로토콜
- TCP 대신 QUIC을 전송 계층으로 사용합니다.
- HTTP/2의 프레임 구조와 유사하지만 QUIC 스트림 위에서 동작합니다.

### 2. QPACK
- HTTP/2의 HPACK을 개선한 헤더 압축 알고리즘입니다.
- HOL 블로킹 없이 효율적인 헤더 압축을 제공합니다.

### 3. 서버 푸시
- HTTP/2와 마찬가지로 서버 푸시를 지원합니다.
- 클라이언트 요청 없이도 서버가 리소스를 보낼 수 있습니다.

### 4. 우선순위 지정
- 스트림에 우선순위를 부여하여 중요한 리소스를 먼저 전송할 수 있습니다.

## 5. HTTP/1.1, HTTP/2, HTTP/3 비교

| 특징 | HTTP/1.1 | HTTP/2 | HTTP/3 |
|------|----------|--------|--------|
| 전송 프로토콜 | TCP | TCP | QUIC (UDP 기반) |
| 연결 | 연결당 하나의 요청 처리 (Keep-alive로 개선) | 하나의 연결로 여러 요청 처리 | 하나의 연결로 여러 요청 처리 |
| 멀티플렉싱 | 제한적 (파이프라이닝) | 지원 (TCP HOL 블로킹 존재) | 향상된 지원 (HOL 블로킹 없음) |
| 헤더 압축 | 없음 | HPACK | QPACK |
| 서버 푸시 | 없음 | 지원 | 지원 |
| 암호화 | 선택적 (HTTPS) | 선택적 (HTTPS) | 필수 (TLS 1.3 내장) |
| 연결 설정 시간 | 느림 (TCP + TLS) | 느림 (TCP + TLS) | 빠름 (0-RTT 또는 1-RTT) |
| 연결 마이그레이션 | 지원 안 함 | 지원 안 함 | 지원 |

## 6. QUIC의 내부 동작 원리

### 1. 연결 설정
- QUIC은 암호화 및 전송 핸드셰이크를 결합하여 연결 설정 시간을 단축합니다.
- 클라이언트는 첫 패킷에 필요한 모든 정보를 포함시킵니다.

### 2. 패킷 구조
- QUIC 패킷은 헤더와 하나 이상의 프레임으로 구성됩니다.
- 대부분의 헤더 필드는 암호화되어 중간자가 볼 수 없습니다.

### 3. 스트림 관리
- QUIC은 양방향 스트림을 제공합니다.
- 각 스트림은 독립적으로 처리되며, 하나의 스트림에서 패킷 손실이 발생해도 다른 스트림은 영향을 받지 않습니다.

### 4. 혼잡 제어
- QUIC은 TCP와 유사한 혼잡 제어 알고리즘을 사용합니다.
- 패킷 손실 감지 및 재전송 메커니즘이 개선되었습니다.

### 5. 연결 ID
- QUIC은 고유한 연결 ID를 사용하여 연결을 식별합니다.
- 이를 통해 IP 주소가 변경되어도 연결을 유지할 수 있습니다.

## 7. 현재 지원 현황

### 브라우저 지원
- Chrome: 버전 87부터 기본 지원
- Firefox: 버전 88부터 지원 (about:config에서 활성화 필요)
- Safari: iOS 14 및 macOS Big Sur부터 지원
- Edge: 버전 87부터 지원 (Chromium 기반)

### 서버 지원
- Nginx: 실험적 모듈로 지원
- Caddy: 버전 2부터 지원
- LiteSpeed: 지원
- Cloudflare: CDN 서비스에서 지원
- Fastly: CDN 서비스에서 지원

### 라이브러리 및 구현체
- quiche (Cloudflare)
- msquic (Microsoft)
- lsquic (LiteSpeed)
- quicly (FastLy)
- ngtcp2

## 8. 구현 고려사항

### 1. 미들박스 호환성
- 일부 방화벽 및 NAT 장치는 UDP 트래픽을 차단하거나 제한할 수 있습니다.
- 대체 방안으로 TCP 기반 HTTP/2로의 폴백이 필요합니다.

### 2. 성능 모니터링
- 기존 TCP 기반 도구로는 QUIC 연결을 모니터링하기 어렵습니다.
- 새로운 모니터링 도구 및 방법이 필요합니다.

### 3. 리소스 사용량
- QUIC은 애플리케이션 레벨에서 구현되므로 CPU 사용량이 더 높을 수 있습니다.
- 서버 리소스 계획 시 이를 고려해야 합니다.

### 4. 배포 전략
- 점진적인 도입이 권장됩니다.
- HTTP/3와 이전 버전을 동시에 지원하는 것이 좋습니다.

## 9. 사용 사례 및 이점

### 1. 모바일 웹
- 불안정한 네트워크 환경에서 더 나은 성능을 제공합니다.
- 연결 마이그레이션을 통해 네트워크 전환 시 연결이 유지됩니다.

### 2. 콘텐츠 전송 네트워크 (CDN)
- 더 빠른 연결 설정으로 콘텐츠 로딩 시간이 단축됩니다.
- 패킷 손실이 많은 환경에서도 안정적인 성능을 제공합니다.

### 3. API 서비스
- 낮은 지연 시간으로 API 응답 속도가 향상됩니다.
- 여러 요청을 동시에 처리할 때 효율성이 증가합니다.

## 10. 미래 전망

- QUIC은 HTTP 외에도 다양한 프로토콜의 기반이 될 가능성이 있습니다.
- DNS over QUIC, WebRTC over QUIC 등의 개발이 진행 중입니다.
- 모바일 및 IoT 환경에서의 활용이 확대될 것으로 예상됩니다.

## 참고 문서
- [RFC 9000: QUIC Transport Protocol](https://datatracker.ietf.org/doc/html/rfc9000)
- [RFC 9001: QUIC TLS](https://datatracker.ietf.org/doc/html/rfc9001)
- [RFC 9002: QUIC Recovery](https://datatracker.ietf.org/doc/html/rfc9002)
- [RFC 9114: HTTP/3](https://datatracker.ietf.org/doc/html/rfc9114)
- [RFC 9204: QPACK](https://datatracker.ietf.org/doc/html/rfc9204)