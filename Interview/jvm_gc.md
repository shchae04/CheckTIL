# JVM에서 GC 대상 객체를 판단하는 기준

### GC(Garbage Collection)

자바의 메모리 관리 방법의 하나로 `JVM`의 `Heap` 영역에서 동적으로 할당했던 메모리 중에서 필요 없어진 객체를 주기적으로 제거하는 것을 의미합니다.

GC는 특정 객체가 사용 중인지 아닌지 판단하기 위해서 `Reachability`라는 개념을 사용합니다. 

### 객체의 도달 가능성 (`Reachability`)

JVM은 특정 객체가 여전히 사용되고 있는지 여부를 도달 가능성(Reachability) 개념을 통해 판단합니다.

- 도달 가능한 객체: 루트 객체(`Root Set`)에서 시작하는 참조 체인을 통해 접근할 수 있는 객체.
- 도달 불가능한 객체: 루트 객체로부터 도달할 수 없는 객체로, 더 이상 사용되지 않는 것으로 판단되어 GC 대상이 됩니다.


### `Reachability` 판단
- 힙 내부 객체 간의 참조
- 스택 영역의 변수에 의한 참조
- JNI에 의해 생성된 객체에 대한 참조 (네이티브 스택 영역)
- 메서드 영역의 정적 변수에 의한 참조

힙 내부 객체 간의 참조를 제외한 나머지를 `Root Set`이라고 합니다.

`Root Set`으로부터 시작한 참조 사슬에 속한 객체들은 도달할 수 있는 객체이며, 이 참조 사슬과 무관한 객체들은 도달하기 어렵기 때문에 GC의 대상이 됩니다.

### 개발자의 GC 관여

자바에서는 java.lang.ref 패키지를 통해 개발자가 GC 동작에 영향을 줄 수 있는 참조 객체를 제공합니다.

- `SoftReference`
    - 원본 객체(Referent)를 감싸며, Root Set으로부터 참조가 없을 경우 남아 있는 힙 메모리의 상황에 따라 GC 여부가 결정됩니다.
- `WeakReference`
  - Root Set으로부터 참조가 없는 경우, 즉시 GC 대상이 됩니다.

이러한 참조 클래스를 활용하면, 개발자는 메모리 사용 상황에 따라 객체의 생존 여부를 조금 더 세밀하게 제어할 수 있습니다.

다만 GC의 시점은 `JVM`에 의해 결정되며, 여러 최적화가 이루어집니다.

#### 결론
JVM은 `Root Set`으로부터 시작하는 참조 체인을 통해 객체의 도달 가능성을 판단하고, 도달할 수 없는 객체를 GC 대상으로 선정합니다. 또한, `SoftReference`와 `WeakReference`를 통해 개발자가 GC 동작에 간접적으로 관여할 수 있습니다.