# 시스템 간 비동기 연동 방식

시스템 간 비동기 연동은 결합도를 낮추고, 호출된 시스템의 응답을 기다리지 않아 사용자 요청에 보다 빠르게 응답할 수 있는 장점이 있습니다. 대표적인 방식은 **메시징 시스템 활용**, **데이터베이스 활용**, **CDC (Change Data Capture) 활용**입니다.

---

## 1. 메시징 시스템 활용 방식

### 설명
- 두 시스템 사이에 메시징 시스템(`Kafka`, `RabbitMQ` 등)을 두어 비동기 방식으로 연동합니다.
- 한 시스템에서 메시지를 생성하여 메시징 시스템에 송신하면, 다른 시스템에서 이를 읽어 처리합니다.
- 높은 처리량을 보장한다는 장점이 있습니다.

### 고려 사항
- **메시지 유실**: 네트워크나 시스템 장애 시 메시지 손실 위험이 있으므로 주의해야 합니다.
- **메시지 소비 순서**: 메시지 순서를 보장해야 할 경우 추가적인 설계가 필요합니다.
- **트랜잭션 관리**:
    - 하나의 트랜잭션 내에서 메시지 전송과 데이터베이스 삽입이 함께 이루어질 때, 예를 들어 데이터베이스 삽입 실패 시 메시지가 전송되거나, 반대로 삽입은 성공했으나 메시지 전송에 실패하는 상황이 발생할 수 있습니다.
    - 이런 경우 두 작업을 원자적으로 처리할 수 있는 방법에 대해 추가 고민이 필요합니다.

---

## 2. 데이터베이스 활용 방식

### 설명
- 데이터베이스를 메시지 큐처럼 활용하는 방법입니다.
- 한 시스템이 데이터베이스 테이블에 메시지 레코드를 삽입하면, 연동 시스템이 주기적으로 테이블을 확인하여 새 메시지가 있으면 처리합니다.
- 트랜잭션과 메시지 순서가 보장되며, 메시지 유실에 대한 우려가 적습니다.

### 고려 사항
- **범용성**: 메시지의 형식이 자주 변경된다면, 해당 레코드의 스키마도 같이 변경해야 하는 부담이 있습니다.
- **추가 고려 사항**: 삭제 정책, 읽기 빈도 등 데이터베이스를 메시지 큐처럼 사용할 때 추가로 고려해야 할 부분들이 존재합니다.

---

## 3. `CDC` (Change Data Capture) 활용 방식

### 설명
- 데이터베이스의 변경 사항을 캡처하여 다른 시스템에 전파하는 방식입니다.
- 별도의 시스템이 데이터베이스의 바이너리 로그 등을 모니터링하여 변경 사항을 감지하고 전파합니다.
- 트랜잭션 보장이 가능하며, 별도의 메시지 생성이나 저장 로직이 필요 없어 애플리케이션 로직이 단순해집니다.

### 고려 사항
- **추가 정보의 한계**: 변경 로그 자체에는 데이터 변경의 이유 등 부가 정보가 부족할 수 있어, 상황에 따라 추가적인 정보 확보가 필요할 수 있습니다.
- **제약 조건**: 변경 로그만으로는 충분한 정보를 제공하지 못할 경우, 활용에 제약이 발생할 수 있습니다.

대표적인 도구 : `Debezuim`

---

각 방식의 장단점과 구현 시 고려사항을 면밀히 검토하여, 시스템의 요구사항에 가장 적합한 비동기 연동 방식을 선택하는 것이 중요합니다.
